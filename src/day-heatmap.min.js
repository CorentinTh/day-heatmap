/**
 *  day-heatmap. (https://github.com/CorentinTh/day-heatmap)
 *  Created by Corentin THOMASSET (https://github.com/CorentinTh)
 *  Licensed under MIT.
 */
var DayHeatmap=function(a,t){if(this._map=function(a,t,e,s,r){return(a-t)/(e-t)*(r-s)+s},this._isObject=function(a){return!!a&&a.constructor===Object},this._isArray=function(a){return!!a&&a.constructor===Array},t&&!this._isObject(t))return void console.error("Second parameter 'options' must be an object.");if(this._colors=["#7ae0cc","#3fc5ab","#379e8a","#28675b","#294C58"],t&&t.colors){if(5!=t.colors.length)return void console.error("Colors must be a 5 elements array.");this._colors=t.colors}if(void 0==document.getElementById(a))return void console.error("First parameter 'element' doesn't exist.");this._options=t,this._element=("#"==a.charAt(0)?"":"#")+a,console.log(this.element);var e=["Mo","Tu","We","Th","Fr","Sa","Su"];$(this._element).addClass("day-heatmap-container"),$(this._element).append("<div class='day'><div class='day-label'></div><div class='hours'></div></div>");for(var s=1;8>s;++s){var r=this._options&&this._options.halfDays&&s%2==0;$(this._element).append("<div class='day' data-day='"+(7==s?0:s)+"'><div class='day-label'>"+(r?"":e[s-1])+"</div><div class='hours'></div></div>")}var o=this;return $(this._element+" .day .hours").each(function(a){for(var t=0;24>t;++t)if(0==a){var e=o._options&&o._options.halfHours&&t%2==1;$(this).append("<div class='hour-label'>"+(e?"":t+"h")+"</div>")}else $(this).append("<div class='hour' data-hour='"+t+"' data-value='0'></div>")}),this.data=function(a){return this._isArray(a)?(this._data=a,this):void console.error("Data must be an array")},this.draw=function(){for(var a=[],t=0;t<this._data.length;++t){var e=this._data[t],s=new Date(1e3*e.timestamp).getDay(),r=new Date(1e3*e.timestamp).getHours(),o=$($("#day-heatmap").find("[data-day='"+s+"']")[0]).find("[data-hour='"+r+"']")[0],i=parseInt($(o).attr("data-value"),10)+e.value;$(o).attr("data-value",i),a.push({value:i,element:o})}var n=this,l=Math.max.apply(Math,a.map(function(a){return a.value}));console.log(l),a.forEach(function(a){0!=a.value&&$(a.element).css("background-color",n._colors[Math.floor(n._map(a.value,0,l,0,4))])})},this};